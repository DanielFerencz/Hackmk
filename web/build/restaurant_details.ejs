<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <title>Restaurant Details</title>
</head>

<body>
    <nav>
        <a href="./index.html">Restaurants</a>
        
        <% if(payload.username) {%>
            <% if(payload.role === 'admin') {%>
                <a href="./create_restaurant">Create Restaurant</a>
            <% } %> 
            <a href="./create_reservation">Create Reservation</a>
            <form method="POST" action="/auth/logout" id="logout">
                <a href="#" onclick="logoutSubmit()">Logout: <%= payload.username %> (<%= payload.role %>)</a>
            </form>
        <% } else { %>
            <a href="./login"> Login</a>
            <a href="./register"> Register</a>
        <% } %> 
    </nav>
    <main>
        <% if(msg.length>0) { %>
            <div class="msg">
            <label id="msg"><%= msg %> </label> 
            </div>
        <%} %>
        <h1><%= restaurant.name %></h1>
        <div class="restaurant">
            <div class="city">City: <%= restaurant.city %></div>
            <div>Str. <%= restaurant.street %></div>
            <div>Nr. <%= restaurant.number %></div>
            <div>Tel: <%= restaurant.telefon %></div>
            <div>Opening hours: <%= restaurant.open %> - <%= restaurant.close %> </div>
        </div>

        <h2>Reservations: </h2>
        <div id="reservations">
            <% if(reservations.length === 0) { %>
                <div class="reservation">
                No registered reservations in the database.
                </div>
            <%} %>
            <% reservations.forEach((reser) => { %>
                <div class="reservation"> Name: <%= reser.name %>, date: <%= reser.date %>, time: <%= reser.time %>
                <% if (payload.username === reser.name) {%> 
                    <a href="#" onclick="deleteReservation(event,'<%= reser._id %>')">Delete Reservation</a>
                <% } %> 
                </div>
            <% }) %> 
        </div>

        <h2> Pictures: </h2>
        <div>
            <% if(pictures.length === 0){ %>
                <div class="picture">
                    No pictures in the database.
                </div>
            <% } %>
            <% pictures.forEach((pic)=> { %>
                <div class="picture">
                    <img src=<%= pic.photo %> alt=<%= pic.name %>>
                </div>
            <%}) %>
        </div>
        <% if(payload.role === 'admin') {%>
            <h2>Upload Photo</h2>
            <form method="POST" action="/uploadPhoto" enctype="multipart/form-data">
                <input id="id" type="hidden" name="id" placeholder="Restaurant ID" value=<%= restaurant._id %>>
                
                <label for="photo"> Photo: </label>
                <input id="photo" type="file" name="photo" required>
                <br>

                <input type="submit" value="Submit">
            </form>
        <% } %> 
    </main>
    <footer>
        <p>Copyright 2021</p>
    </footer>
    <script src="/delete_reservation.js"></script>
</body>

</html>